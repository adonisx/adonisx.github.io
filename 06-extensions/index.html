<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Extensions | AdonisX</title>
    <meta name="generator" content="VuePress 1.4.1">
    <link rel="icon" href="/logo.png">
    <link rel="manifest" href="/manifest.json">
    <link rel="apple-touch-icon" href="/icons/apple-touch-icon-152x152.png">
    <link rel="mask-icon" href="/icons/safari-pinned-tab.svg" color="#3eaf7c">
    <meta name="description" content="Fastest way to create simple Rest API by defining database models and their relations.">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/icons/msapplication-icon-144x144.png">
    <meta name="msapplication-TileColor" content="#000000">
    <link rel="preload" href="/assets/css/0.styles.9c53e19f.css" as="style"><link rel="preload" href="/assets/js/app.43c0c0c3.js" as="script"><link rel="preload" href="/assets/js/2.8ce952cd.js" as="script"><link rel="preload" href="/assets/js/12.56d3e1c9.js" as="script"><link rel="prefetch" href="/assets/js/10.ad2de074.js"><link rel="prefetch" href="/assets/js/11.6f0241c8.js"><link rel="prefetch" href="/assets/js/13.c06ac246.js"><link rel="prefetch" href="/assets/js/14.13d729ed.js"><link rel="prefetch" href="/assets/js/3.71f42757.js"><link rel="prefetch" href="/assets/js/4.a96dfb43.js"><link rel="prefetch" href="/assets/js/5.0912c8bf.js"><link rel="prefetch" href="/assets/js/6.e1174c18.js"><link rel="prefetch" href="/assets/js/7.06cb3a2f.js"><link rel="prefetch" href="/assets/js/8.d899a4e8.js"><link rel="prefetch" href="/assets/js/9.50c0648f.js">
    <link rel="stylesheet" href="/assets/css/0.styles.9c53e19f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">AdonisX</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://github.com/adonisx/adonisx" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://github.com/adonisx/adonisx-cli" target="_blank" rel="noopener noreferrer" class="nav-link external">
  CLI
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://sonarcloud.io/dashboard?id=ozziest_apix" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Sonarcloud
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://github.com/adonisx/adonisx" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://github.com/adonisx/adonisx-cli" target="_blank" rel="noopener noreferrer" class="nav-link external">
  CLI
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://sonarcloud.io/dashboard?id=ozziest_apix" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Sonarcloud
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/" class="sidebar-link">Home</a></li><li><a href="/01-introduction/" class="sidebar-link">Introduction</a></li><li><a href="/02-getting-started/" class="sidebar-link">Getting Started</a></li><li><a href="/03-routes/" class="sidebar-link">Routes</a></li><li><a href="/04-models/" class="sidebar-link">Models</a></li><li><a href="/05-queries/" class="sidebar-link">Queries</a></li><li><a href="/06-extensions/" class="active sidebar-link">Extensions</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/06-extensions/#why" class="sidebar-link">Why?</a></li><li class="sidebar-sub-header"><a href="/06-extensions/#events" class="sidebar-link">Events</a></li><li class="sidebar-sub-header"><a href="/06-extensions/#actions" class="sidebar-link">Actions</a></li><li class="sidebar-sub-header"><a href="/06-extensions/#variables" class="sidebar-link">Variables</a></li></ul></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="extensions"><a href="#extensions" class="header-anchor">#</a> Extensions</h1> <h2 id="why"><a href="#why" class="header-anchor">#</a> Why?</h2> <p>In the real world, everybody needs more than saving and listing records. Everybody needs more complicated logic in their code. <strong>AdonisX</strong> provides you a basic structure of an API. It provides you basic CRUD actions with where dynamic query options. But when you need custom logic, you will not be alone. <strong>AdonisX</strong> provides you some points to extend your HTTP requests and manipulate them.</p> <p>There are two different ways to add your business logic;</p> <ul><li><strong>Events</strong></li> <li><strong>Actions</strong></li></ul> <p>You may use <strong>Events</strong> and <strong>Actions</strong> to add your business logic.</p> <h2 id="events"><a href="#events" class="header-anchor">#</a> Events</h2> <p><strong>Events</strong> are AdonisJS' features and you can read its documentation in <a href="https://adonisjs.com/docs/4.1/events" target="_blank" rel="noopener noreferrer">here<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>. It is very simple to use. First, you define an event to listen;</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// start/event.js</span>

Event<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'new::user'</span><span class="token punctuation">,</span> <span class="token string">'User.registered'</span><span class="token punctuation">)</span>
</code></pre></div><p>Then you create a file which is called <code>User.js</code> under the <code>app/Listeners</code> directory like this;</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// app/Listeners/User.js</span>

<span class="token keyword">const</span> User <span class="token operator">=</span> exports <span class="token operator">=</span> module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

User<span class="token punctuation">.</span><span class="token function-variable function">register</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">params</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// Your business logic.</span>
<span class="token punctuation">}</span>
</code></pre></div><p>After these definitions, whenever you fire the event, your <code>register</code> method will be triggered.</p> <div class="language-js extra-class"><pre class="language-js"><code>Event<span class="token punctuation">.</span><span class="token function">fire</span><span class="token punctuation">(</span><span class="token string">'new::user'</span><span class="token punctuation">)</span>
</code></pre></div><p>AdonisX uses this structure. It fires constant events when an event has appeared. For example, if you want to handle the user's request before pagination, you should define an event like this;</p> <div class="language-js extra-class"><pre class="language-js"><code>Event<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'onBeforePaginateUser'</span><span class="token punctuation">,</span> <span class="token string">'User.onBeforePaginate'</span><span class="token punctuation">)</span>
</code></pre></div><p>AdonisX automatically fires <code>onBeforePaginate</code> event before the pagination in <code>MainController</code>. You can use the following list to understand which events will be triggered by AdonisX;</p> <table><thead><tr><th>EventName{Model}</th> <th>Variables</th></tr></thead> <tbody><tr><td>onBeforeCreate{User}</td> <td>request, params, data</td></tr> <tr><td>onBeforeUpdate{User}</td> <td>request, params, item</td></tr> <tr><td>onBeforeDelete{User}</td> <td>request, params, query</td></tr> <tr><td>onBeforePaginate{User}</td> <td>request, params, query</td></tr> <tr><td>onBeforeShow{User}</td> <td>request, params, query</td></tr> <tr><td>onAfterCreate{User}</td> <td>request, params, data, item</td></tr> <tr><td>onAfterUpdate{User}</td> <td>request, params, item</td></tr> <tr><td>onAfterDelete{User}</td> <td>request, params, item</td></tr> <tr><td>onAfterPaginate{User}</td> <td>request, params, result</td></tr> <tr><td>onAfterShow{User}</td> <td>request, params, item</td></tr></tbody></table> <h2 id="actions"><a href="#actions" class="header-anchor">#</a> Actions</h2> <p>The main difference between <strong>Actions</strong> and <strong>Events</strong> is; events are <strong>asynchronous</strong>. It means that if you are using an <strong>action</strong> and handle the request, the HTTP request cycle waits for you to do your task. But in events, when you handle the event, the HTTP requests cycle keeps working and returns a response. So, if you want to send an e-mail to the user, you should use <strong>Events</strong>. On the other hand, if you want to be involved in the query or any business logic in the HTTP request cycle, you should use <strong>Actions</strong>.</p> <p>Using <strong>Actions</strong> is very easy. The only thing you do, you should create an Action file for your model under the directory <code>app/Actions</code>.</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// app/Actions/UserActions.js</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token keyword">async</span> <span class="token function">onBeforePaginate</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> request<span class="token punctuation">,</span> params<span class="token punctuation">,</span> query <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Implement your business logic in here.</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>If you create an action file like this, every time before pagination of <strong>User.js</strong> model, this method will be triggered. The only thing you should care about is using the same naming structure for model and action file;</p> <table><thead><tr><th>Model</th> <th>Actions</th></tr></thead> <tbody><tr><td>User.js</td> <td>UserActions.js</td></tr> <tr><td>Users.js</td> <td>UsersActions.js</td></tr> <tr><td>UserPost.js</td> <td>UserPostActions.js</td></tr></tbody></table> <blockquote><p>Actions are loaded in the <strong>initialization</strong> process at *<strong>once</strong>. So your action methods should be <a href="https://en.wikipedia.org/wiki/State_(computer_science)#Program_state" target="_blank" rel="noopener noreferrer">stateless<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p></blockquote> <p>You can handle every action on models. Please look at the following tables;</p> <table><thead><tr><th>ActionName</th> <th>Variables</th></tr></thead> <tbody><tr><td>onBeforeCreate</td> <td>request, params, data</td></tr> <tr><td>onBeforeUpdateQuery</td> <td>request, params, query</td></tr> <tr><td>onBeforeUpdate</td> <td>request, params, item</td></tr> <tr><td>onBeforeDelete</td> <td>request, params, query</td></tr> <tr><td>onBeforePaginate</td> <td>request, params, query</td></tr> <tr><td>onBeforeShow</td> <td>request, params, query</td></tr> <tr><td>onAfterCreate</td> <td>request, params, data, item</td></tr> <tr><td>onAfterUpdateQuery</td> <td>request, params, item</td></tr> <tr><td>onAfterUpdate</td> <td>request, params, item</td></tr> <tr><td>onAfterDelete</td> <td>request, params, item</td></tr> <tr><td>onAfterPaginate</td> <td>request, params, result</td></tr> <tr><td>onAfterShow</td> <td>request, params, item</td></tr></tbody></table> <h2 id="variables"><a href="#variables" class="header-anchor">#</a> Variables</h2> <p>There are some variables which you can use in a trigger or event function;</p> <ul><li><a href="https://adonisjs.com/docs/4.1/request" target="_blank" rel="noopener noreferrer">request<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> Request object of <a href="https://adonisjs.com" target="_blank" rel="noopener noreferrer">AdonisJs<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><strong>params</strong>: Query parameters in url. (<code>api/users/:userId/posts/:id</code>, <code>userId</code> and <code>id</code>)</li> <li><strong>data</strong>: The data has been sent by user to create or update.</li> <li><strong>item</strong>: The record which is active.</li> <li><strong>query</strong>: The <a href="https://adonisjs.com" target="_blank" rel="noopener noreferrer">AdonisJs<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>' <a href="https://adonisjs.com/docs/4.1/lucid#_query_builder" target="_blank" rel="noopener noreferrer">query<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> object before executing query.</li></ul></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/05-queries/" class="prev">
        Queries
      </a></span> <!----></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.43c0c0c3.js" defer></script><script src="/assets/js/2.8ce952cd.js" defer></script><script src="/assets/js/12.56d3e1c9.js" defer></script>
  </body>
</html>
